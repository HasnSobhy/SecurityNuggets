### Challenge

```
Zippy
688
Have fun!

NOTE: The flag is NOT in the standard auctf{} format

Author: OG_Commando
```

### Recon and Solve

* Some recon. It should be a password protected zip file.
```
kali@kali:~/Downloads/zippy$ pwd
/home/kali/Downloads/zippy

kali@kali:~/Downloads/zippy$ file zippy.zip 
zippy.zip: Zip archive data, at least v?[0x333] to extract

kali@kali:~/Downloads/zippy$ zipinfo zippy.zip 
Archive:  zippy.zip
Zip file size: 1049 bytes, number of entries: 1
-rw-r--r--  6.3 unx      908 Bx u099 20-Mar-12 17:58 unzipme.zip
1 file, 908 bytes uncompressed, 859 bytes compressed:  5.4%

kali@kali:~/Downloads/zippy$ unzip zippy.zip 
Archive:  zippy.zip
   skipping: unzipme.zip             need PK compat. v5.1 (can do v4.6)

kali@kali:~/Downloads/zippy$ 7z x zippy.zip 
7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21
p7zip Version 16.02 (locale=en_US.utf8,Utf16=on,HugeFiles=on,64 bits,2 CPUs Intel(R) Core(TM) i5-6360U CPU @ 2.00GHz (406E3),ASM,AES-NI)

Scanning the drive for archives:
1 file, 1049 bytes (2 KiB)

Extracting archive: zippy.zip
--
Path = zippy.zip
Type = zip
Physical Size = 1049

    
Enter password (will not be echoed):
ERROR: Wrong password : unzipme.zip
                  
Sub items Errors: 1

Archives with Errors: 1

Sub items Errors: 1
kali@kali:~/Downloads/zippy$ 
```

* `fcrackzip` was not successful right away even with the -U option. Tried rockyou.txt and some other ones too....
```
kali@kali:~/Downloads/zippy$ fcrackzip -u -D -p '/usr/share/wordlists/rockyou.txt' zippy.zip
```

* `rarcrack` bruteforce takes forever so lets have it as last resort

```
kali@kali:~/Downloads/zippy$ rarcrack --type 7z --threads 4 zippy.zip 
RarCrack! 0.2 by David Zoltan Kedves (kedazo@gmail.com)

INFO: the specified archive type: 7z
INFO: cracking zippy.zip, status file: zippy.zip.xml
INFO: Resuming cracking from password: '0DY'
Probing: '0XF' [405 pwds/sec]
Probing: '1hL' [415 pwds/sec]
Probing: '1Bt' [407 pwds/sec]
Probing: '1Vn' [411 pwds/sec]
Probing: '2fh' [411 pwds/sec]
Probing: '2zk' [414 pwds/sec]
Probing: '2Ti' [412 pwds/sec]
Probing: '3dh' [413 pwds/sec]
Probing: '3wZ' [407 pwds/sec]
Probing: '3QK' [408 pwds/sec]
Probing: '4aD' [411 pwds/sec]
```

* (Bing! a thought from the past) Pull in the hash from the zip file and crack elsewhere. Thats how `John` crack zip would work. Lets do it!

```
kali@kali:~/Downloads/zippy$ sudo zip2john zippy.zip > zippy.hashes
ver 81.9 zippy.zip/unzipme.zip is not encrypted, or stored with non-handled compression type


kali@kali:~/Downloads/zippy$ sudo john --wordlist=/usr/share/wordlists/rockyou.txt zippy.hashes 
Using default input encoding: UTF-8
Loaded 1 password hash (ZIP, WinZip [PBKDF2-SHA1 256/256 AVX2 8x])
Will run 2 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status

8297018229       (zippy.zip/unzipme.zip)
1g 0:00:06:59 DONE (2020-04-06 19:16) 0.002383g/s 28102p/s 28102c/s 28102C/s 82973..82634904
Use the "--show" option to display all of the cracked passwords reliably
Session completed


kali@kali:~/Downloads/zippy$ 7z x zippy.zip 

7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21
p7zip Version 16.02 (locale=en_US.utf8,Utf16=on,HugeFiles=on,64 bits,2 CPUs Intel(R) Core(TM) i5-6360U CPU @ 2.00GHz (406E3),ASM,AES-NI)

Scanning the drive for archives:
1 file, 1049 bytes (2 KiB)

Extracting archive: zippy.zip
--
Path = zippy.zip
Type = zip
Physical Size = 1049

    
Enter password (will not be echoed):
Everything is Ok  

Size:       908
Compressed: 1049
```

```
kali@kali:~/Downloads/zippy$ 7z x unzipme.zip 

7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21
p7zip Version 16.02 (locale=en_US.utf8,Utf16=on,HugeFiles=on,64 bits,2 CPUs Intel(R) Core(TM) i5-6360U CPU @ 2.00GHz (406E3),ASM,AES-NI)

Scanning the drive for archives:
1 file, 908 bytes (1 KiB)

Extracting archive: unzipme.zip
--
Path = unzipme.zip
Type = zip
Physical Size = 908

    
Enter password (will not be echoed):
ERROR: Wrong password : do_it_again.zip
                      
Sub items Errors: 1

Archives with Errors: 1

Sub items Errors: 1


kali@kali:~/Downloads/zippy$ sudo zip2john unzipme.zip
unzipme.zip/do_it_again.zip:$zip2$*0*1*0*34905e0be29aed9f*2d1d*2be*d21995d8b02399519a53aadfcbd34c1382543742007381aed1be67373da8c8daad26fc932ccbb30b7345b161d9405cbf9594d9bdbb325ef06adda7aaff9bd54e24c90b76b424810c309bed577133dc0d9dcfbf55fe95fb864e93bd256b8595a07dabc21bfbe4c9b3667635eb880cc5c27d386b46a01604af02e904fc3c6f7b62770b49408a06baee061db31862dc6546576b942075cae21c8e584c3f36cdc2a9ba0133ea9395a732ef2122941122187099e0e86ed9ffda0f81ff70b92a46eb674d2249c37df599cd81f5c2618963964f5c4edd7cba5b701ed592f62e8ddf04ef10e27c215abe12da12a3568837d81a42c14fd5c81a0e2d3fd9606001ec0416e1f4386ce87b94e7a6f2b53d32de0b94b3b625839269901dcb66333da8835e0c2bcdf616bc87fc9133174b637c2399eabcea96d069ade3f974fdb46338ea1b3e9510a9da18f672cb5a317f847879f945358df4c947e5793e57d05d72eb6cfcbd981830ac06dd831f3d6787b4eb73fde2d7a11e00cb6b9306c613c3a937f8a33db641014ed3517e6ae1c7e5c3976cdb8d72117b1babb9baad125c7aa445e9673b988b1e1ca647da61b5a989213b13d26df8453d0fd46ef1ec1a385a166ed750f75d194c04ee7fe3ad0e40e81f6f7e2c9f85fb76860763162ab9e98bda7d111c0b82a3ce286e70ee14b243f9c486b6d5064ae10f3afd201fbd42ee860a3f82ae94a60025944e8e1bea84add763a22edcfd3498304674ae826f023f20442e5acc06dfbe3e1a8617bac5b3e36bdc83a736b0a58b7145998011d987a0ecaf5a2e60db78cf3c89bf56563d2ec37969e183efaae6a468d04327bf42a2b1e304ea66bc78eccb6c16e7e3b328cbdbde7f736b67c907cd05be0969fc7b53ef70fb654f969819bec3991eaa6889dc7e1c88294fdf1d23467e6e09ce6fa9ddc3c5f21b7a2cd79fac045fae721640d244e045158a836d69de914ea769cbf2927576a285a35c*3d1eab46d20220335353*$/zip2$:do_it_again.zip:unzipme.zip:unzipme.zip
ver 81.9 unzipme.zip/do_it_again.zip is not encrypted, or stored with non-handled compression type

kali@kali:~/Downloads/zippy$ sudo zip2john unzipme.zip > unzipme.hashes
ver 81.9 unzipme.zip/do_it_again.zip is not encrypted, or stored with non-handled compression type

kali@kali:~/Downloads/zippy$ sudo john --wordlist=/usr/share/wordlists/rockyou.txt unzipme.hashes 
Using default input encoding: UTF-8
Loaded 1 password hash (ZIP, WinZip [PBKDF2-SHA1 256/256 AVX2 8x])
Will run 2 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
pugh1948         (unzipme.zip/do_it_again.zip)
1g 0:00:02:40 DONE (2020-04-06 19:21) 0.006213g/s 27971p/s 27971c/s 27971C/s pulafutecuru..puet14
Use the "--show" option to display all of the cracked passwords reliably
Session completed


kali@kali:~/Downloads/zippy$ 7z x unzipme.zip 

7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21
p7zip Version 16.02 (locale=en_US.utf8,Utf16=on,HugeFiles=on,64 bits,2 CPUs Intel(R) Core(TM) i5-6360U CPU @ 2.00GHz (406E3),ASM,AES-NI)

Scanning the drive for archives:
1 file, 908 bytes (1 KiB)

Extracting archive: unzipme.zip
--
Path = unzipme.zip
Type = zip
Physical Size = 908

    
Would you like to replace the existing file:
  Path:     ./do_it_again.zip
  Size:     0 bytes
  Modified: 2020-03-12 18:48:56
with the file from archive:
  Path:     do_it_again.zip
  Size:     754 bytes (1 KiB)
  Modified: 2020-03-12 18:48:56
? (Y)es / (N)o / (A)lways / (S)kip all / A(u)to rename all / (Q)uit? Y

                      
Enter password (will not be echoed):
Everything is Ok      

Size:       754
Compressed: 908
```

```
kali@kali:~/Downloads/zippy$ 7z x do_it_again.zip 

7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21
p7zip Version 16.02 (locale=en_US.utf8,Utf16=on,HugeFiles=on,64 bits,2 CPUs Intel(R) Core(TM) i5-6360U CPU @ 2.00GHz (406E3),ASM,AES-NI)

Scanning the drive for archives:
1 file, 754 bytes (1 KiB)

Extracting archive: do_it_again.zip
--
Path = do_it_again.zip
Type = zip
Physical Size = 754

    
Enter password (will not be echoed):
ERROR: Wrong password : again.zip
                
Sub items Errors: 1

Archives with Errors: 1

Sub items Errors: 1


kali@kali:~/Downloads/zippy$ sudo zip2john do_it_again.zip > do_it_again.hashes
ver 81.9 do_it_again.zip/again.zip is not encrypted, or stored with non-handled compression type


kali@kali:~/Downloads/zippy$ sudo john --wordlist=/usr/share/wordlists/rockyou.txt do_it_again.hashes 
Using default input encoding: UTF-8
Loaded 1 password hash (ZIP, WinZip [PBKDF2-SHA1 256/256 AVX2 8x])
Will run 2 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
cobra0           (do_it_again.zip/again.zip)
1g 0:00:00:32 DONE (2020-04-06 21:01) 0.03053g/s 30141p/s 30141c/s 30141C/s computer?..chrismoney
Use the "--show" option to display all of the cracked passwords reliably
Session completed


kali@kali:~/Downloads/zippy$ 7z x do_it_again.zip 

7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21
p7zip Version 16.02 (locale=en_US.utf8,Utf16=on,HugeFiles=on,64 bits,2 CPUs Intel(R) Core(TM) i5-6360U CPU @ 2.00GHz (406E3),ASM,AES-NI)

Scanning the drive for archives:
1 file, 754 bytes (1 KiB)

Extracting archive: do_it_again.zip
--
Path = do_it_again.zip
Type = zip
Physical Size = 754

    
Would you like to replace the existing file:
  Path:     ./again.zip
  Size:     0 bytes
  Modified: 2020-03-12 18:36:59
with the file from archive:
  Path:     again.zip
  Size:     620 bytes (1 KiB)
  Modified: 2020-03-12 18:36:59
? (Y)es / (N)o / (A)lways / (S)kip all / A(u)to rename all / (Q)uit? Y

                
Enter password (will not be echoed):
Everything is Ok

Size:       620
Compressed: 754
```

```
kali@kali:~/Downloads/zippy$ sudo zip2john again.zip > again.hashes
ver 81.9 again.zip/keep_going.zip is not encrypted, or stored with non-handled compression type

kali@kali:~/Downloads/zippy$ sudo john --wordlist=/usr/share/wordlists/rockyou.txt again.hashes 
Using default input encoding: UTF-8
Loaded 1 password hash (ZIP, WinZip [PBKDF2-SHA1 256/256 AVX2 8x])
Will run 2 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
madboy99         (again.zip/keep_going.zip)
1g 0:00:03:50 DONE (2020-04-06 23:45) 0.004330g/s 25594p/s 25594c/s 25594C/s madbunch3..macon1983
Use the "--show" option to display all of the cracked passwords reliably
Session completed

kali@kali:~/Downloads/zippy$ 7z x again.zip 

7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21
p7zip Version 16.02 (locale=en_US.utf8,Utf16=on,HugeFiles=on,64 bits,2 CPUs Intel(R) Core(TM) i5-6360U CPU @ 2.00GHz (406E3),ASM,AES-NI)

Scanning the drive for archives:
1 file, 620 bytes (1 KiB)

Extracting archive: again.zip
--
Path = again.zip
Type = zip
Physical Size = 620

    
Enter password (will not be echoed):
Everything is Ok     

Size:       479
Compressed: 620
```

```
kali@kali:~/Downloads/zippy$ 7z x keep_going.zip 

7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21
p7zip Version 16.02 (locale=en_US.utf8,Utf16=on,HugeFiles=on,64 bits,2 CPUs Intel(R) Core(TM) i5-6360U CPU @ 2.00GHz (406E3),ASM,AES-NI)

Scanning the drive for archives:
1 file, 479 bytes (1 KiB)

Extracting archive: keep_going.zip
--
Path = keep_going.zip
Type = zip
Physical Size = 479

    
Enter password (will not be echoed):
ERROR: Wrong password : almost_there.zip
                       
Sub items Errors: 1

Archives with Errors: 1

Sub items Errors: 1


kali@kali:~/Downloads/zippy$ sudo zip2john keep_going.zip > keep_going.hashes
ver 81.9 keep_going.zip/almost_there.zip is not encrypted, or stored with non-handled compression type


kali@kali:~/Downloads/zippy$ sudo john --wordlist=/usr/share/wordlists/rockyou.txt keep_going.hashes 
Using default input encoding: UTF-8
Loaded 1 password hash (ZIP, WinZip [PBKDF2-SHA1 256/256 AVX2 8x])
Will run 2 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
racoon211        (keep_going.zip/almost_there.zip)
1g 0:00:02:05 DONE (2020-04-07 01:38) 0.007989g/s 35308p/s 35308c/s 35308C/s radb4kfb..rachana01
Use the "--show" option to display all of the cracked passwords reliably
Session completed


kali@kali:~/Downloads/zippy$ 7z x keep_going.zip 

7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21
p7zip Version 16.02 (locale=en_US.utf8,Utf16=on,HugeFiles=on,64 bits,2 CPUs Intel(R) Core(TM) i5-6360U CPU @ 2.00GHz (406E3),ASM,AES-NI)

Scanning the drive for archives:
1 file, 479 bytes (1 KiB)

Extracting archive: keep_going.zip
--
Path = keep_going.zip
Type = zip
Physical Size = 479

    
Would you like to replace the existing file:
  Path:     ./almost_there.zip
  Size:     0 bytes
  Modified: 2020-03-12 18:34:52
with the file from archive:
  Path:     almost_there.zip
  Size:     330 bytes (1 KiB)
  Modified: 2020-03-12 18:34:52
? (Y)es / (N)o / (A)lways / (S)kip all / A(u)to rename all / (Q)uit? Y

                       
Enter password (will not be echoed):
Everything is Ok       

Size:       330
Compressed: 479
```

```
kali@kali:~/Downloads/zippy$ 7z x almost_there.zip 

7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21
p7zip Version 16.02 (locale=en_US.utf8,Utf16=on,HugeFiles=on,64 bits,2 CPUs Intel(R) Core(TM) i5-6360U CPU @ 2.00GHz (406E3),ASM,AES-NI)

Scanning the drive for archives:
1 file, 330 bytes (1 KiB)

Extracting archive: almost_there.zip
--
Path = almost_there.zip
Type = zip
Physical Size = 330

    
Enter password (will not be echoed):
ERROR: Wrong password : nice.zip
               
Sub items Errors: 1

Archives with Errors: 1

Sub items Errors: 1


kali@kali:~/Downloads/zippy$ sudo zip2john almost_there.zip > almost_there.hashes
ver 81.9 almost_there.zip/nice.zip is not encrypted, or stored with non-handled compression type


kali@kali:~/Downloads/zippy$ sudo john --wordlist=/usr/share/wordlists/rockyou.txt almost_there.hashes 
Using default input encoding: UTF-8
Loaded 1 password hash (ZIP, WinZip [PBKDF2-SHA1 256/256 AVX2 8x])
Will run 2 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
imverygoooooooooooooooooooooooooooooooooooooooooooooooo (almost_there.zip/nice.zip)
1g 0:00:03:58 DONE (2020-04-07 01:45) 0.004194g/s 30808p/s 30808c/s 30808C/s in_199..imperno
Use the "--show" option to display all of the cracked passwords reliably
Session completed


kali@kali:~/Downloads/zippy$ 7z x almost_there.zip 

7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21
p7zip Version 16.02 (locale=en_US.utf8,Utf16=on,HugeFiles=on,64 bits,2 CPUs Intel(R) Core(TM) i5-6360U CPU @ 2.00GHz (406E3),ASM,AES-NI)

Scanning the drive for archives:
1 file, 330 bytes (1 KiB)

Extracting archive: almost_there.zip
--
Path = almost_there.zip
Type = zip
Physical Size = 330

    
Would you like to replace the existing file:
  Path:     ./nice.zip
  Size:     0 bytes
  Modified: 2020-03-12 18:33:49
with the file from archive:
  Path:     nice.zip
  Size:     207 bytes (1 KiB)
  Modified: 2020-03-12 18:33:49
? (Y)es / (N)o / (A)lways / (S)kip all / A(u)to rename all / (Q)uit? Y

               
Enter password (will not be echoed):
Everything is Ok

Size:       207
Compressed: 330
```

```
kali@kali:~/Downloads/zippy$ 7z x nice.zip 

7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21
p7zip Version 16.02 (locale=en_US.utf8,Utf16=on,HugeFiles=on,64 bits,2 CPUs Intel(R) Core(TM) i5-6360U CPU @ 2.00GHz (406E3),ASM,AES-NI)

Scanning the drive for archives:
1 file, 207 bytes (1 KiB)

Extracting archive: nice.zip
--
Path = nice.zip
Type = zip
Physical Size = 207

    
Enter password (will not be echoed):
ERROR: Wrong password : flag.txt
               
Sub items Errors: 1

Archives with Errors: 1

Sub items Errors: 1


kali@kali:~/Downloads/zippy$ sudo zip2john nice.zip > nice.hashes
ver 81.9 nice.zip/flag.txt is not encrypted, or stored with non-handled compression type


kali@kali:~/Downloads/zippy$ sudo john --wordlist=/usr/share/wordlists/rockyou.txt nice.hashes 
Using default input encoding: UTF-8
Loaded 1 password hash (ZIP, WinZip [PBKDF2-SHA1 256/256 AVX2 8x])
Will run 2 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
LEFTEYE          (nice.zip/flag.txt)
1g 0:00:00:07 DONE (2020-04-07 01:46) 0.1308g/s 36992p/s 36992c/s 36992C/s bedshaped..7deenero
Use the "--show" option to display all of the cracked passwords reliably
Session completed


kali@kali:~/Downloads/zippy$ 7z x nice.zip 

7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21
p7zip Version 16.02 (locale=en_US.utf8,Utf16=on,HugeFiles=on,64 bits,2 CPUs Intel(R) Core(TM) i5-6360U CPU @ 2.00GHz (406E3),ASM,AES-NI)

Scanning the drive for archives:
1 file, 207 bytes (1 KiB)

Extracting archive: nice.zip
--
Path = nice.zip
Type = zip
Physical Size = 207

    
Would you like to replace the existing file:
  Path:     ./flag.txt
  Size:     0 bytes
  Modified: 2020-03-12 18:30:32
with the file from archive:
  Path:     flag.txt
  Size:     15 bytes (1 KiB)
  Modified: 2020-03-12 18:30:32
? (Y)es / (N)o / (A)lways / (S)kip all / A(u)to rename all / (Q)uit? Y

               
Enter password (will not be echoed):
Everything is Ok

Size:       15
Compressed: 207
```

### Flag

```
kali@kali:~/Downloads/zippy$ cat flag.txt 
y0ud1d17#15789
kali@kali:~/Downloads/zippy$ 
```

### Reference
* https://blog.sleeplessbeastie.eu/2015/05/18/how-to-crack-archive-password/
* https://dfir.science/2014/07/how-to-cracking-zip-and-rar-protected.html